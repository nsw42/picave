{
    "title": "Config file schema",
    "description": "Validation for config.json",
    "type": "object",
    "properties": {
        "executables": {
            "description": "Where to find executables",
            "type": "object",
            "properties": {
                // NB. This list must be a superset of the 'supported_players' enum,
                // with any additional binaries that are needed. Currently, that's
                // only youtube-dl.
                "mpg123": { "$ref": "#/definitions/executable" },
                "mplayer": { "$ref": "#/definitions/executable" },
                "mpv": { "$ref": "#/definitions/executable" },
                "omxplayer": { "$ref": "#/definitions/executable" },
		        "libvlc": { "$ref": "#/definitions/executable" },
                "vlc": { "$ref": "#/definitions/executable" },
                "youtube-dl": { "$ref": "#/definitions/executable" },
            }
        },
        "filetypes": {
            "description": "Which player to use for which file extension",
            "type": "object",
            "properties": {
                ".mp3": { "$ref": "#/definitions/player" },
                ".mp4": { "$ref": "#/definitions/player" },
                ".mkv": { "$ref": "#/definitions/player" }
            }
        },
        "video_cache_directory": {
            "description": "Where to store cached video files",
            "type": "string"
        },
        "warm_up_music_directory": {
            "description": "Where to find MP3s of music for warm-up",
            "type": "string"
        },
        "favourites": {
            "description": "List of ids of sessions to highlight",
            "type": "array",
            "items": {
                "type": "string"
            }
        },
        "show_favourites_only": {
            "description": "Whether to show only favourite (true) or all (false) videos",
            "type": "boolean"
        },
        "power_levels": {
            "description": "Configured power levels (one or both of FTP and MAX) for the current user, stored as a mapping from video id (or the literal 'default') to an object that maps 'FTP' or 'MAX' to an absolute value, or a string that is a percentage of FTP. (Obvs, default FTP cannot be a percentage of FTP)",
            "type": "object",
            "required": ["default"],
            "properties": {
                "default": {
                    "type": "object",
                    "required": ["FTP"]
                },
            },
            "patternProperties": {
                "^.*$": {
                    "type": "object",
                    "properties": {
                        "FTP": { "type": "integer" },
                        "MAX": {
                            "oneOf": [
                                { "type": "integer" },
                                { "type": "string", "pattern": "^[0-9.]*%?$" },
                            ]
                        }
                    }
                }
            }
        }
    },
    "required": ["video_cache_directory"],
    "definitions": {
        "executable": {
            "type": "object",
            "properties": {
                "path": {
                    "description": "The path of the binary",
                    "type": "string"
                }
            },
            "required": ["path"]
        },
        "player": {
            "type": "object",
            "properties": {
                "player": {
                    "$ref": "#/definitions/supported_players"
                },
                "options": {
                    "description": "Command-line arguments for the player",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "parameters": {
                    "description": "Parameters that control the behaviour of the player",
                    "type": "object"
                }
            },
            "required": ["player"]
        },
        "supported_players": {
            "description": "The player to use to play this type of file",
            "type": "string",
            "enum": [
                "mpg123",
                "mplayer",
                "mpv",
                "omxplayer",
		        "libvlc",
                "vlc"
            ]
        }
    }
}
